---
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd; please edit that file. -->
<!-- Run with: suppressWarnings(rmarkdown::render("README.Rmd", quiet = TRUE)) -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  dpi = 100
)
options(plot2.silent = FALSE,
        plot2.colour = NULL,
        plot2.colour_font_secondary = NULL)
```

# `plot2`: Simplified and Enhanced Data Visualisation in R

`plot2` is a simple yet powerful extension of `ggplot2`, designed to streamline the process of creating high-quality data visualisations in R by removing most of the manual work. Built with the philosophy of **Less Typing, More Plotting**, `plot2` automates many of the routine tasks that typically require substantial code when plotting with `ggplot2`. It even renders pre-processing steps in, for example, `dplyr`, `tidyr`, and `forcats` largely superfluous. This package allows you to focus on the insights and stories your data can tell, rather than the intricate details of plot construction.

Where `ggplot2` involves calling many different _functions_ such as `ggplot()`, `aes()`, `geom_col()`, `facet_wrap()`, `theme()`, and `scale_y_continuous()`, `plot2` only requires filling in the necessary _arguments_ of a single function.

> For a **comprehensive guide to using `plot2`**, including advanced features and customisation options, please see [the full vignette here](https://msberends.github.io/plot2/articles/plot2.html).

## Key Features

- **Plotting with as Few Lines as Possible:** No need to type `ggplot()`, `aes()`, `geom_col()`, `facet_wrap()`, `theme()`, or `scale_y_continuous()`. A single `plot2()` call is sufficient.
- **Automatic Plot Selection:** `plot2` automatically chooses the most appropriate plot type based on your data, saving time and effort.
- **In-line Data Transformations:** Eliminate manual pre-processing steps, for example in `dplyr` and `tidyr`, by performing data transformations directly within the plotting function, including axis and plot titles.
- **Enhanced Sorting and Faceting:** Easily sort and facet your data with simple arguments, streamlining the creation of complex multi-panel plots.
- **New Clean Theme:** Includes `theme_minimal2()`, a minimalist theme based on `theme_minimal()`, further optimised for clear and professional output, making it well suited to PDF publications, scientific manuscripts, and presentations.
- **Seamless Integration with ggplot2:** Retain the full power and flexibility of `ggplot2` while benefiting from `plot2`â€™s streamlined interface.

## Philosophy

`ggplot2` is a versatile tool that has become a cornerstone of data visualisation in R, providing users with substantial control over their plots. However, this flexibility often results in repetitive and verbose code, particularly for routine tasks such as setting axis labels, choosing plot types, or transforming data.

`plot2` complements `ggplot2` by offering a more streamlined and intuitive interface. It simplifies plot creation by automatically handling many implementation details, without sacrificing flexibility or expressive power. Whether you are exploring data or preparing a publication-ready visualisation, `plot2` enables you to work more efficiently with less code.

## Installation

Install the latest version of `plot2` as follows:

```{r, eval = FALSE}
install.packages("plot2",
                 repos = c("https://cran.r-project.org",
                           "https://msberends.r-universe.dev"))

# OR:

remotes::install_github("msberends/plot2")
```

## Examples

> For **all supported plot types**, see the overview: https://msberends.github.io/plot2/articles/supported_types.html.

Here is a minimal example to get started with `plot2`:

```{r}
library(plot2)

head(iris)

# No variables specified, so plot2() determines them automatically.
# The default type will be points because the first two variables are numeric.
iris |>
  plot2()

# If x and y are specified, no additional mapping is set:
iris |> 
  plot2(Sepal.Width, Sepal.Length)
iris |> 
  plot2(Species, Sepal.Length)

# Arguments are in the order: x, y, category, facet
iris |> 
  plot2(Sepal.Length, Sepal.Width, Petal.Length, Species)

iris |> 
  plot2(Sepal.Length, Sepal.Width, Petal.Length, Species,
        colour = "viridis")
iris |> 
  plot2(Sepal.Length, Sepal.Width, Petal.Length, Species,
        colour = c("white", "red", "black"))

# y can contain multiple named columns
iris |> 
  plot2(x = Sepal.Length,
        y = c(Length = Petal.Length, Width = Petal.Width),
        category.title = "Petal property")
iris |>
  plot2(x = Species, y = where(is.double))
  
# The category type can consist of one or more aesthetics
iris |>
  plot2(zoom = TRUE,
        category.type = c("colour", "shape"),
        size = 3)
iris |>
  plot2(zoom = TRUE,
        category = Petal.Length,
        category.type = c("colour", "size"),
        colour = "viridis")

# Easily add smoothing
iris |>
  plot2(zoom = TRUE,
        smooth = TRUE)
iris |>
  plot2(zoom = TRUE,
        smooth = TRUE,
        smooth.method = "lm")

# Support for a secondary y-axis
mtcars |>
  plot2(x = mpg,
        y = hp,
        y_secondary = disp ^ 2, 
        y_secondary.scientific = TRUE,
        title = "Secondary y-axis sets colour to the axis titles")

admitted_patients

# Arguments are in the order: x, y, category, facet
admitted_patients |>
  plot2(hospital, age)

admitted_patients |>
  plot2(hospital, age, gender)
  
admitted_patients |>
  plot2(hospital, age, gender, ward)
  
# Use any function for y
admitted_patients |>
  plot2(hospital, median(age), gender, ward)
admitted_patients |>
  plot2(hospital, n(), gender, ward)
admitted_patients |>
  plot2(x = hospital,
        y = age,
        category = gender,
        colour = c("F" = "#3F681C", "M" = "#375E97"),
        colour_fill = "#FFBB00",
        linewidth = 1.25,
        y.age = TRUE)

admitted_patients |>
  plot2(age, type = "hist")

# Titles can include calculations and support {glue}
admitted_patients |>
  plot2(age, type = "hist",
        title = paste("Based on n =", n_distinct(patient_id), "patients"),
        subtitle = paste("Total rows:", n()),
        caption = glue::glue("From {n_distinct(hospital)} hospitals"),
        x.title = paste("Age ranging from", paste(range(age), collapse = " to ")))
 
# The default type is column; data labels are automatically
# set for non-continuous types:
admitted_patients |> 
  plot2(hospital, n(), gender)
  
admitted_patients |> 
  plot2(hospital, n(), gender,
        stacked = TRUE)
        
admitted_patients |> 
  plot2(hospital, n(), gender,
        stacked_fill = TRUE)

# Two categories may benefit from a dumbbell plot:
admitted_patients |> 
  plot2(hospital, median(age), gender, type = "dumbbell")
 
# Sort in any direction:
admitted_patients |> 
  plot2(hospital, n(), gender,
        x.sort = "freq-asc",
        stacked = TRUE)

admitted_patients |> 
  plot2(hospital, n(), gender,
        x.sort = c("B", "D", "A"),
        category.sort = "alpha-desc",
        stacked = TRUE)
        
# Support for Sankey plots
Titanic |>
  plot2(x = c(Age, Class, Survived),
        category = Sex,
        type = "sankey")

# Matrix support, for example cor()
correlation_matrix <- cor(mtcars)
class(correlation_matrix)
head(correlation_matrix)
mtcars |> 
  cor() |>
  plot2()

mtcars |> 
  cor() |>
  plot2(colour = c("blue3", "white", "red3"),
        datalabels = TRUE,
        category.title = "*r*-value",
        title =  "Correlation matrix")

# plot2() supports all S3 extensions available through
# ggplot2::fortify() and broom::augment(), such as regression models:
lm(mpg ~ hp, data = mtcars) |> 
  plot2(x = mpg ^ -3,
        y = hp ^ 2,
        smooth = TRUE,
        smooth.method = "lm",
        smooth.formula = "y ~ log(x)",
        title = "Titles and captions support markdown",
        subtitle = "Axis titles contain square notation: x^2")

# sf objects, geographic plots using simple features, are also supported
netherlands |> 
  plot2()
netherlands |> 
  plot2(colour_fill = "viridis", colour_opacity = 0.75) |>
  add_sf(netherlands, colour = "black", colour_fill = NA)
```

```{r, fig.showtext = TRUE}
# Support for any system or Google font
mtcars |>
  plot2(mpg, hp,
        font = "Rock Salt",
        title = "This plot uses a Google Font")
```

## Ways to input arguments

Like `plot()`, pass `x` and `y` in your preferred style:

```{r, eval = FALSE}
plot2(mtcars, mpg, hp)

mtcars %>% plot2(mpg, hp)

plot2(hp ~ mpg, data = mtcars)

mtcars |> plot2(mpg, hp)
```

## Shiny app

You can create plots interactively using the built-in Shiny app. All `plot2` arguments are available within it. In RStudio, an add-in menu item is also provided.

```{r, eval = FALSE}
iris |>
  create_interactively()
```

![Shiny app example](man/figures/create_interactively.jpg)

## Getting Involved

Contributions to `plot2` are welcome, including reporting issues, suggesting features, or submitting pull requests. Familiarity with `ggplot2` and the tidyverse is particularly valuable as the package continues to evolve.

## Previous Iteration

Although first released here in August 2024, this package builds on years of development and hundreds of Git commits in an earlier iteration available at https://github.com/certe-medical-epidemiology/certeplot2.

## License

This project is licensed under the GNU GPL v2.0 License. See the LICENSE file for details.
